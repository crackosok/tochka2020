## API Интернет-магазина

### Развертывание
.env.example переименовать в .env (уже включил туда нужные доступы к БД докера для ускорения процесса)

#### Сборка и запуск Docker
`docker-compose build app`

`docker-compose up -d`

#### Стандартные процедуры для запуска laravel-приложения
`docker-compose exec app composer install`

`docker-compose exec app php artisan migrate --seed`

Сидер создает 30 случайных продуктов в базе, сама база создается при запуске Docker через initdb

### Описание методов

#### Получение списка товаров

`GET /api/items`

* Входные данные отсутствуют
* Выходные данные: список товаров, оставшихся на складе либо сообщение об отсутствии таких с кодом 404

#### Получение информации о товаре

`GET /api/items/{item_id}`

* Входные данные: ID товара в URL
* Выходные данные: информация о найденном товаре либо сообщение об отсутствии такого с кодом 404

#### Совершение заказа

`POST /api/items`

* Входные данные: данные о клиенте (имя, почта, телефон), данные о товарах в заказе (ID, количество, текущая цена)
* Выходные данные: ID совершенного заказа либо сообщение об ошибке

##### Пример входных данных
```json
    {
        'customer_name': 'Vasya',
        'customer_email': 'vasya@pupkin.ru',
        'customer_phone': '78005553535',
        'items': [
            {'item_id': 1, 'quantity': 2, 'price': 100},
            {'item_id': 2, 'quantity': 1, 'price': 200},
            {'item_id': 3, 'quantity': 3, 'price': 300},
        ]
    }
```

### Ежедневный отчет

Отправляется стандартным task scheduler в Laravel, для работы нужно добавить его в крон

`* * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1`


### Тесты
Для методов API написаны тесты, проверяющие основной функционал

`php artisan test`

### Общий формат выходных данных
API отдает JSON, первое поле в котором `success` - `true` или `false` в зависимости от успешности запроса.

При успешном запросе вторым полем будет `data`, которое будет содержать сами выходные данные метода.

При ошибке вторым полем будет `error`, которое будет содержать код и сообщение ошибки.

#### Пример ответа на успешный запрос

```json
{
    'success': true,
    'data': {
        'order_id': 1
    }
}
```

#### Пример ответа на неудачный запрос

```json
{
    'success': false,
    'error': {
        'code': 404,
        'message': 'No item found with that ID'
    }
}
```

### Не реализовано
Учитывание одновременного заказа последнего товара несколькими клиентами - просто не додумался, как быть в такой ситуации